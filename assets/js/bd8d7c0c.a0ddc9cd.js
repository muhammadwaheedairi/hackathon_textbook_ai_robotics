"use strict";(globalThis.webpackChunkmy_website=globalThis.webpackChunkmy_website||[]).push([[48],{6092:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>s,metadata:()=>o,toc:()=>c});const o=JSON.parse('{"id":"module-1-robotic-nervous-system/week-3-python-agent-integration/chapter-5-python-agent-integration","title":"Python Agent Integration with ROS Controllers","description":"Overview","source":"@site/docs/module-1-robotic-nervous-system/week-3-python-agent-integration/chapter-5-python-agent-integration.md","sourceDirName":"module-1-robotic-nervous-system/week-3-python-agent-integration","slug":"/module-1-robotic-nervous-system/week-3-python-agent-integration/chapter-5-python-agent-integration","permalink":"/hackathon_textbook_ai_robotics/docs/module-1-robotic-nervous-system/week-3-python-agent-integration/chapter-5-python-agent-integration","draft":false,"unlisted":false,"editUrl":"https://github.com/muhammadwaheedairi/hackathon_textbook_ai_robotics/edit/main/my-website/docs/module-1-robotic-nervous-system/week-3-python-agent-integration/chapter-5-python-agent-integration.md","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"title":"Python Agent Integration with ROS Controllers","sidebar_label":"Chapter 5: Python Agent Integration","sidebar_position":5},"sidebar":"tutorialSidebar","previous":{"title":"Chapter 4: Services & Packages","permalink":"/hackathon_textbook_ai_robotics/docs/module-1-robotic-nervous-system/week-2-ros-2-fundamentals/chapter-4-services-packages"},"next":{"title":"Chapter 6: URDF Modeling","permalink":"/hackathon_textbook_ai_robotics/docs/module-1-robotic-nervous-system/week-3-python-agent-integration/chapter-6-urdf-xacro-modeling"}}');var r=t(4848),i=t(8453);const s={title:"Python Agent Integration with ROS Controllers",sidebar_label:"Chapter 5: Python Agent Integration",sidebar_position:5},a="Chapter 5: Python Agent Integration with ROS Controllers",l={},c=[{value:"Overview",id:"overview",level:2},{value:"Learning Objectives",id:"learning-objectives",level:2},{value:"Python Agent Integration with ROS Controllers",id:"python-agent-integration-with-ros-controllers",level:2},{value:"Agent-Controller Architecture",id:"agent-controller-architecture",level:3},{value:"Types of ROS Controllers",id:"types-of-ros-controllers",level:3},{value:"Control Interface Patterns",id:"control-interface-patterns",level:3},{value:"Communication Mechanisms",id:"communication-mechanisms",level:3},{value:"Python Agent Implementation Considerations",id:"python-agent-implementation-considerations",level:3},{value:"ros2_control Framework Components",id:"ros2_control-framework-components",level:3},{value:"Controller Configuration",id:"controller-configuration",level:3},{value:"Code Examples",id:"code-examples",level:2},{value:"Python Agent with Joint State Subscriber",id:"python-agent-with-joint-state-subscriber",level:3},{value:"Controller Interface Node",id:"controller-interface-node",level:3},{value:"Advanced Python Agent with Action Client",id:"advanced-python-agent-with-action-client",level:3},{value:"Summary",id:"summary",level:2},{value:"Key Takeaways",id:"key-takeaways",level:2},{value:"What&#39;s Next",id:"whats-next",level:2}];function d(n){const e={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.header,{children:(0,r.jsx)(e.h1,{id:"chapter-5-python-agent-integration-with-ros-controllers",children:"Chapter 5: Python Agent Integration with ROS Controllers"})}),"\n",(0,r.jsx)(e.h2,{id:"overview",children:"Overview"}),"\n",(0,r.jsx)(e.p,{children:"This chapter explores how to integrate Python-based intelligent agents with ROS 2 controllers for robot actuation. You'll learn how to bridge high-level AI decision-making with low-level hardware control, enabling sophisticated robot behaviors."}),"\n",(0,r.jsx)(e.h2,{id:"learning-objectives",children:"Learning Objectives"}),"\n",(0,r.jsxs)(e.admonition,{title:"Learning Objectives",type:"info",children:[(0,r.jsx)(e.p,{children:"By the end of this chapter, you will be able to:"}),(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Integrate Python agents with ROS 2 controllers"}),"\n",(0,r.jsx)(e.li,{children:"Understand the agent-controller architecture"}),"\n",(0,r.jsx)(e.li,{children:"Implement control interfaces for robot actuation"}),"\n",(0,r.jsx)(e.li,{children:"Configure ros2_control framework components"}),"\n"]})]}),"\n",(0,r.jsx)(e.h2,{id:"python-agent-integration-with-ros-controllers",children:"Python Agent Integration with ROS Controllers"}),"\n",(0,r.jsx)(e.p,{children:"Python agents in robotics are software components that implement decision-making algorithms, planning systems, or AI-based control strategies. These agents must interface with ROS controllers, which handle the low-level hardware control and ensure precise execution of commands. The integration enables sophisticated robot behaviors by combining high-level cognitive capabilities with precise low-level control."}),"\n",(0,r.jsx)(e.h3,{id:"agent-controller-architecture",children:"Agent-Controller Architecture"}),"\n",(0,r.jsx)(e.p,{children:"The integration between Python agents and ROS controllers typically follows this layered pattern:"}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Agent Layer"}),": Implements high-level decision-making, planning, and reasoning using AI algorithms"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Interface Layer"}),": Translates agent decisions into controller commands and handles communication protocols"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Controller Layer"}),": Executes precise hardware control based on received commands"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Hardware Layer"}),": Physical robot components that execute the actions"]}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"types-of-ros-controllers",children:"Types of ROS Controllers"}),"\n",(0,r.jsx)(e.p,{children:"ROS 2 supports several types of controllers for different control needs:"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Joint Trajectory Controller"}),": Executes complete trajectories with position, velocity, and acceleration"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Position Controllers"}),": Simple position control for individual joints"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Velocity Controllers"}),": Velocity-based control for smooth motion"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Effort Controllers"}),": Direct torque/force control for precise force application"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Forward Command Controllers"}),": Forward desired states to hardware interfaces"]}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"control-interface-patterns",children:"Control Interface Patterns"}),"\n",(0,r.jsx)(e.p,{children:"There are several common patterns for integrating Python agents with ROS controllers:"}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Direct Command Pattern"}),": Agent sends immediate commands to controllers"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Trajectory Planning Pattern"}),": Agent plans complete trajectories and sends them to trajectory controllers"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Feedback Control Pattern"}),": Agent uses sensor feedback to adjust control commands"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"State Machine Pattern"}),": Agent implements complex behaviors through state transitions"]}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"communication-mechanisms",children:"Communication Mechanisms"}),"\n",(0,r.jsx)(e.p,{children:"Python agents communicate with controllers using several ROS 2 communication patterns:"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Topics"}),": For continuous state publishing and command streaming"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Services"}),": For synchronous configuration and immediate actions"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Actions"}),": For long-running tasks with progress feedback"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Parameters"}),": For dynamic configuration changes"]}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"python-agent-implementation-considerations",children:"Python Agent Implementation Considerations"}),"\n",(0,r.jsx)(e.p,{children:"When implementing Python agents for ROS controller integration, consider:"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Real-time constraints"}),": Ensure control loop timing requirements are met"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Safety boundaries"}),": Implement safety checks and limits"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Error handling"}),": Gracefully handle controller failures and exceptions"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"State management"}),": Maintain consistent state between agent and controllers"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Logging and diagnostics"}),": Track agent decisions and controller responses"]}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"ros2_control-framework-components",children:"ros2_control Framework Components"}),"\n",(0,r.jsxs)(e.p,{children:["The ",(0,r.jsx)(e.code,{children:"ros2_control"})," framework provides several key components for Python agent integration:"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Hardware Interface"}),": Abstracts communication with specific hardware platforms"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Controller Manager"}),": Manages the lifecycle of controllers (load, configure, start, stop)"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Controller Types"}),": Pre-built controllers for common control tasks"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Transmission Interface"}),": Maps actuator commands to joint commands"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Resource Manager"}),": Tracks and manages hardware resources"]}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"controller-configuration",children:"Controller Configuration"}),"\n",(0,r.jsx)(e.p,{children:"Controllers are configured using YAML files that specify parameters such as:"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-yaml",children:"controller_manager:\n  ros__parameters:\n    update_rate: 100  # Hz\n\n    joint_trajectory_controller:\n      type: joint_trajectory_controller/JointTrajectoryController\n\njoint_trajectory_controller:\n  ros__parameters:\n    joints:\n      - joint1\n      - joint2\n      - joint3\n    command_interfaces:\n      - position\n    state_interfaces:\n      - position\n      - velocity\n"})}),"\n",(0,r.jsx)(e.h2,{id:"code-examples",children:"Code Examples"}),"\n",(0,r.jsx)(e.h3,{id:"python-agent-with-joint-state-subscriber",children:"Python Agent with Joint State Subscriber"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\nfrom sensor_msgs.msg import JointState\nfrom std_msgs.msg import Float64MultiArray\nimport numpy as np\n\nclass RobotAgentNode(Node):\n    def __init__(self):\n        super().__init__('robot_agent_node')\n\n        self.joint_state_subscriber = self.create_subscription(\n            JointState,\n            '/joint_states',\n            self.joint_state_callback,\n            10\n        )\n\n        self.joint_command_publisher = self.create_publisher(\n            Float64MultiArray,\n            '/position_commands',\n            10\n        )\n\n        self.current_positions = {}\n        self.timer = self.create_timer(0.1, self.agent_decision_callback)\n\n        self.get_logger().info('Robot Agent Node initialized')\n\n    def joint_state_callback(self, msg):\n        \"\"\"Update current joint positions\"\"\"\n        for i, name in enumerate(msg.name):\n            if i < len(msg.position):\n                self.current_positions[name] = msg.position[i]\n\n        self.get_logger().info(f'Updated joint positions: {self.current_positions}')\n\n    def agent_decision_callback(self):\n        \"\"\"Make decisions based on current state\"\"\"\n        if len(self.current_positions) > 0:\n            target_positions = []\n            for joint_name, current_pos in self.current_positions.items():\n                target_pos = current_pos + 0.01\n                target_positions.append(target_pos)\n\n            command_msg = Float64MultiArray()\n            command_msg.data = target_positions\n            self.joint_command_publisher.publish(command_msg)\n\n            self.get_logger().info(f'Published joint commands: {target_positions}')\n\ndef main(args=None):\n    rclpy.init(args=args)\n    robot_agent_node = RobotAgentNode()\n\n    try:\n        rclpy.spin(robot_agent_node)\n    except KeyboardInterrupt:\n        pass\n    finally:\n        robot_agent_node.destroy_node()\n        rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,r.jsx)(e.h3,{id:"controller-interface-node",children:"Controller Interface Node"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\nfrom trajectory_msgs.msg import JointTrajectory, JointTrajectoryPoint\nfrom builtin_interfaces.msg import Duration\n\nclass ControllerInterfaceNode(Node):\n    def __init__(self):\n        super().__init__('controller_interface_node')\n\n        self.trajectory_publisher = self.create_publisher(\n            JointTrajectory,\n            '/joint_trajectory_controller/joint_trajectory',\n            10\n        )\n\n        self.timer = self.create_timer(2.0, self.send_trajectory_command)\n\n        self.get_logger().info('Controller Interface Node initialized')\n\n    def send_trajectory_command(self):\n        \"\"\"Send a trajectory command to the controller\"\"\"\n        trajectory_msg = JointTrajectory()\n        trajectory_msg.joint_names = ['joint1', 'joint2', 'joint3']\n\n        point = JointTrajectoryPoint()\n        point.positions = [0.5, 1.0, -0.5]\n        point.velocities = [0.0, 0.0, 0.0]\n        point.accelerations = [0.0, 0.0, 0.0]\n        point.time_from_start = Duration(sec=1, nanosec=0)\n\n        trajectory_msg.points = [point]\n        self.trajectory_publisher.publish(trajectory_msg)\n\n        self.get_logger().info(f'Published trajectory command: {point.positions}')\n\ndef main(args=None):\n    rclpy.init(args=args)\n    controller_interface_node = ControllerInterfaceNode()\n\n    try:\n        rclpy.spin(controller_interface_node)\n    except KeyboardInterrupt:\n        pass\n    finally:\n        controller_interface_node.destroy_node()\n        rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,r.jsx)(e.h3,{id:"advanced-python-agent-with-action-client",children:"Advanced Python Agent with Action Client"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-python",children:'import rclpy\nfrom rclpy.action import ActionClient\nfrom rclpy.node import Node\nfrom control_msgs.action import FollowJointTrajectory\nfrom trajectory_msgs.msg import JointTrajectory, JointTrajectoryPoint\nfrom builtin_interfaces.msg import Duration\n\nclass AdvancedRobotAgentNode(Node):\n    def __init__(self):\n        super().__init__(\'advanced_robot_agent_node\')\n\n        self._action_client = ActionClient(\n            self,\n            FollowJointTrajectory,\n            \'joint_trajectory_controller/follow_joint_trajectory\'\n        )\n\n        self.timer = self.create_timer(5.0, self.execute_trajectory_callback)\n\n        self.get_logger().info(\'Advanced Robot Agent Node initialized\')\n\n    def execute_trajectory_callback(self):\n        """Execute a planned trajectory using action client"""\n        goal_msg = FollowJointTrajectory.Goal()\n        goal_msg.trajectory.joint_names = [\'joint1\', \'joint2\', \'joint3\']\n\n        point1 = JointTrajectoryPoint()\n        point1.positions = [0.0, 0.0, 0.0]\n        point1.velocities = [0.0, 0.0, 0.0]\n        point1.time_from_start = Duration(sec=1, nanosec=0)\n\n        point2 = JointTrajectoryPoint()\n        point2.positions = [0.5, 0.5, 0.5]\n        point2.velocities = [0.0, 0.0, 0.0]\n        point2.time_from_start = Duration(sec=2, nanosec=0)\n\n        point3 = JointTrajectoryPoint()\n        point3.positions = [0.0, 0.0, 0.0]\n        point3.velocities = [0.0, 0.0, 0.0]\n        point3.time_from_start = Duration(sec=3, nanosec=0)\n\n        goal_msg.trajectory.points = [point1, point2, point3]\n\n        self._send_goal_async(goal_msg)\n\n    def _send_goal_async(self, goal_msg):\n        """Send goal to trajectory controller"""\n        self.get_logger().info(\'Waiting for action server...\')\n\n        if not self._action_client.wait_for_server(timeout_sec=5.0):\n            self.get_logger().error(\'Action server not available\')\n            return\n\n        future = self._action_client.send_goal_async(\n            goal_msg,\n            feedback_callback=self.feedback_callback\n        )\n\n        future.add_done_callback(self.goal_response_callback)\n\n    def goal_response_callback(self, future):\n        """Handle goal response"""\n        goal_handle = future.result()\n        if not goal_handle.accepted:\n            self.get_logger().info(\'Goal rejected\')\n            return\n\n        self.get_logger().info(\'Goal accepted\')\n\n        get_result_future = goal_handle.get_result_async()\n        get_result_future.add_done_callback(self.get_result_callback)\n\n    def get_result_callback(self, future):\n        """Handle result of trajectory execution"""\n        result = future.result().result\n        self.get_logger().info(f\'Trajectory execution result: {result.error_code}\')\n\n    def feedback_callback(self, feedback_msg):\n        """Handle feedback during trajectory execution"""\n        feedback = feedback_msg.feedback\n        self.get_logger().info(f\'Trajectory progress: {feedback.joint_names}\')\n\ndef main(args=None):\n    rclpy.init(args=args)\n    advanced_agent_node = AdvancedRobotAgentNode()\n\n    try:\n        rclpy.spin(advanced_agent_node)\n    except KeyboardInterrupt:\n        pass\n    finally:\n        advanced_agent_node.destroy_node()\n        rclpy.shutdown()\n\nif __name__ == \'__main__\':\n    main()\n'})}),"\n",(0,r.jsx)(e.h2,{id:"summary",children:"Summary"}),"\n",(0,r.jsx)(e.p,{children:"Python agents provide the cognitive layer for robot decision-making, while ROS controllers handle precise hardware execution. Integrating these components through topics, services, and actions enables sophisticated robot behaviors that combine high-level intelligence with low-level control precision."}),"\n",(0,r.jsx)(e.h2,{id:"key-takeaways",children:"Key Takeaways"}),"\n",(0,r.jsx)(e.admonition,{title:"Key Takeaways",type:"tip",children:(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"Python agents implement high-level decision-making and planning algorithms"}),"\n",(0,r.jsx)(e.li,{children:"ROS controllers execute precise hardware control based on agent commands"}),"\n",(0,r.jsx)(e.li,{children:"Multiple communication patterns (topics, services, actions) enable flexible integration"}),"\n",(0,r.jsx)(e.li,{children:"The ros2_control framework provides standardized interfaces for controller management"}),"\n"]})}),"\n",(0,r.jsx)(e.h2,{id:"whats-next",children:"What's Next"}),"\n",(0,r.jsx)(e.p,{children:"In the next chapter, we'll explore URDF modeling for robot description, learning how to define robot structures and properties for simulation and control."})]})}function h(n={}){const{wrapper:e}={...(0,i.R)(),...n.components};return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(d,{...n})}):d(n)}},8453:(n,e,t)=>{t.d(e,{R:()=>s,x:()=>a});var o=t(6540);const r={},i=o.createContext(r);function s(n){const e=o.useContext(i);return o.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function a(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:s(n.components),o.createElement(i.Provider,{value:e},n.children)}}}]);